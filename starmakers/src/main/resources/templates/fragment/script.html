<th:block th:fragment="script">
    <!-- js ê°€ì ¸ì˜¤ëŠ” ìˆœì„œ -->
    <!-- jQuery -->
    <!-- jQueryê¸°ë°˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <!-- ì‚¬ìš©ì ì •ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ -->
    <!-- <script src="/js/script.js"></script> -->

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>

    <!-- <script src="/lib/summernote-lite.js"></script> -->
    <!-- <script src="/lib/summernote-ko-KR.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- swiper -->  
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>

        $(document).ready(function () {

            // ì¹´ë“œì´í™íŠ¸
            $(document).on('mousemove', '.effect', function (e) {
                var container = $(this);
                var overlay = container.find('.card-overlay');

                var x = e.offsetX;
                var y = e.offsetY;
                var rotateY = -1 / 5 * x + 20;
                var rotateX = 4 / 30 * y - 20;

                overlay.css('background-position', `${x / 5 + y / 5}%`);
                container.css('transform', `perspective(350px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`);
            });

            $(document).on('mouseout', '.effect', function () {
                var container = $(this);
                var overlay = container.find('.card-overlay');

                overlay.css('filter', 'opacity(0)');
                container.css('transform', 'perspective(350px) rotateY(0deg) rotateX(0deg)');
            });

            $(document).on('mouseenter', '.effect', function () {
                var overlay = $(this).find('.card-overlay');
                overlay.css('filter', 'opacity(0.8)');
            });

            // í´ë¦­ì´ë²¤íŠ¸ ì²˜ë¦¬
            let clickTimer;
            let isDoubleClick = false;

            $(document).on('click', '.card', function () {

                var no = $(this).attr("data-no");

                if (isDoubleClick) {
                    isDoubleClick = false;
                    return;
                }

                clickTimer = setTimeout(() => {
                    if (!isDoubleClick) {
                        window.location="/page/starCard/starRead?starNo="+no;
                    }
                }, 250);
            });

            // ë”ë¸”í´ë¦­
            $(document).on('dblclick', '.card', function (e) {
                clearTimeout(clickTimer);
                isDoubleClick = true;

                var userNo = "[[${session.user != null ? session.user.userNo : ''}]]";
                var starNo = $(this).attr("data-no");
                var csrfToken = "[[${_csrf.token}]]";

                if (userNo === '') {
                    alert("ë¡œê·¸ì¸ì„ í•˜ì‹œì˜¤!");
                    return;
                }

                $.ajax({
                    url: '/page/like', // ì„œë²„ì˜ ì¢‹ì•„ìš” ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” API ì—”ë“œí¬ì¸íŠ¸
                    method: 'POST',
                    data: {
                        userNo: userNo,
                        starNo: starNo
                    },
                    beforeSend: function (xhr) {
                        // ğŸ’ CSRF í† í°ì„ ìš”ì²­ í—¤ë”ì— ì¶”ê°€
                        xhr.setRequestHeader('X-CSRF-TOKEN', csrfToken);
                    },
                    success: function (response) {
                        // í•˜íŠ¸ ëª¨ì–‘ ì´í™íŠ¸ ì¶”ê°€
                        let heart = $('<div class="heart"></div>');
                        $('body').append(heart);
                        heart.css({
                            top: e.pageY - 25,
                            left: e.pageX - 25
                        });

                        setTimeout(() => {
                            heart.remove();
                        }, 1000);

                        // ì¢‹ì•„ìš” ì•„ì´ì½˜ í´ë˜ìŠ¤ í† ê¸€
                        $(this).find('.fa-thumbs-up').toggleClass('fa-regular fa-solid');
                    }.bind(this), // this ë°”ì¸ë”©
                    error: function (xhr, status, error) {
                        console.error("ì¢‹ì•„ìš” ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨:", error);
                    }
                });
            });

        });

    </script>

</th:block>